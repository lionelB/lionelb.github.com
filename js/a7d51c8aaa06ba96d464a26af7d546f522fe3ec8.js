(function(c){var a=0;var b=1;c.minicycle=function(i,o){var j=this,n=c(i),d=n.attr("id")||"mnc"+a++,f="mnc-navigator",l,h,k,m;var g={auto:true,selectedClass:"mnc-active",duration:3000,position:0,width:300,height:200,transition:"slow",onMinicycle:function(){trace("onMinicycle")}};j.init=function(){j.params=c.extend({},g,o);n.css("overflow","hidden").css("list-style-type","none").css("position","relative").css("height",j.params.height).css("width",j.params.width).css("margin","0").css("padding","0");var p=document.createElement("ul");p.className=f;m=c(i).find("li").each(function(q,r){c(r).css("top","0").css("position","absolute");c(p).append('<li><a href="#'+d+"-"+q+'" rel="'+q+'">'+q+"</li>")});k=m.size();n.empty();l=j.params.position%k;$nav=n.after(p).next().wrap("<nav/>");c("a",$nav[0]).click(function(q){if(l!=this.rel){e(this.rel)}return false});c("a",$nav[0]).eq(l).addClass(j.params.selectedClass);n.append(m.eq(l).hide().delay(500).fadeIn());h=setTimeout(j.nextSlide,j.params.duration+500)};j.nextSlide=function(){e(l+1)};j.prevSlide=function(){e(l-1)};j.destroy=function(){clearTimeout(h);m=null;n.removeData("minicycle");n=null};var e=function(p){clearTimeout(h);var q={};var r=n.css("width");var t="left";var s=j.params.transition;p=p%k;trace("show",p);var r=n.css("width");q[t]="-"+r;n.children().last().stop().css(t,0).delay("fast").animate(q,s,function(){c(this).remove()});n.append(m.eq(p));q[t]=0;n.children().last().stop().css(t,r).animate(q,s,function(){if(j.params.auto===true){h=setTimeout(j.nextSlide,j.params.duration)}});l=p;c("a."+j.params.selectedClass,$nav[0]).removeClass(j.params.selectedClass);c('a[href^="#'+d+'"]',$nav[0]).eq(p).addClass(j.params.selectedClass)};j.init()};c.fn.minicycle=function(d){return this.each(function(f){if(undefined==c(this).data("minicycle")){var e=new c.minicycle(this,d);c(this).data("minicycle",e)}})}})(jQuery);window.log=function(){log.history=log.history||[];log.history.push(arguments);if(this.console){arguments.callee=arguments.callee.caller;var a=[].slice.call(arguments);(typeof console.log==="object"?log.apply.call(console.log,console,a):console.log.apply(console,a))}};window.trace=window.log;(function(e){function h(){}for(var g="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,timeStamp,profile,profileEnd,time,timeEnd,trace,warn".split(","),f;f=g.pop();){e[f]=e[f]||h}})((function(){try{console.log();return window.console}catch(a){return window.console={}}})());var overlay;var $viewport;var current_idx;var projects=[];var Project=function(f,c,e,d,b,a){this.p_id=isNaN(f)?undefined:f;this.name=c||"";this.title=e||"";this.desc=d||"";this.tech=b||[];this.medias=a||[]};function setContent(g,d){var c=$(".carrousel > ul",d[0]).data("minicycle");if(undefined!=c){c.destroy()}d.empty();d.append("<h1>"+g.name+"</h1><div><h2>"+g.title+'</h2><div class="details">'+g.desc+'</div><div class="technos"><h3>Technologies utilisées :</h3>'+g.tech.join(", ")+'</div></div><div class="carrousel"/>');var b=d.find(".carrousel");b.append("<ul></ul>");var f=document.createElement("ul");for(var e=0,a;e<g.medias.length;++e){a=document.createElement("li");a.appendChild(g.medias[e].cloneNode());f.appendChild(a)}b.find("ul").append(f);reflowText($("h1+div",d[0]).first());d.prepend('<a href="#" class="bt-close" title="Fermer">Fermer <span>x</span></a>');$("a.bt-close",d[0]).hover(function(){$(this)},function(){}).click(function(h){closeDetail();removeNavigation();return false});$(".carrousel > ul",d[0]).minicycle({width:423,height:332})}function reflowText(e){var d=e[0].children[0];var b=$(e[0].children[1]);var g=e[0].children[2];var a=e.css("height");var i=b.outerHeight(true)-b.outerHeight(false);var c=$(e[0]).outerHeight(false)-d.offsetHeight-g.offsetHeight-i;b.css("height",c)}function addCloseBt(){}function closeDetail(){$viewport.find(".carrousel > ul").data("minicycle").destroy();$viewport.empty();removeOverlay()}function removeOverlay(){$("#bg_overlay").remove();$("#vpt").remove()}function addNavigation(a){a.after('<nav id="nav-projects"><a href="#prev" class="prev">Projet précédent</a><a href="#next" class="next">Projet suivant</a></nav>');$("#nav-projects").hide().css("margin-left","-450px").delay("fast").animate({opacity:"toggle",marginLeft:"-413px"});$("#nav-projects a.prev").click(function(){if(current_idx==0){current_idx=projects.length}current_idx=(current_idx-1)%projects.length;setContent(projects[current_idx],a);return false});$("#nav-projects a.next").click(function(){current_idx=(current_idx+1)%projects.length;setContent(projects[current_idx],a);return false})}function removeNavigation(){$("#nav-projects").fadeOut(function(){$(this).remove()})}$.fn.ready(function(){overlay=$("#bg_overlay");$viewport=$("#vpt");var b=$viewport[0];removeOverlay();$viewport.empty();$("#exp dl dd").hide();$("section h1 .nav-link, footer .nav-link").click(function(e){var d=$("#"+e.target.attributes.href.value.split("#")[1]);value=d.offset().top;$("html,body").animate({scrollTop:value},"slow");e.preventDefault()});var c=0;var a=$("#exp dl").each(function(n,j){var e=this.getElementsByTagName("dt");var o=this.getElementsByTagName("dd");var l=-1,f=e.length;var d,m,i,k,h,p;while(++l<f){p=e[l].innerText.split(":");d=p[0].replace(/^[ \s]+|[ \s]+$/g,"");m=p[1].replace(/[ \s]+/g," ").replace(/^[ \s]+|[ \s]+$/g,"");i=o[l].children[0].innerHTML.replace(/[ \s]+/g," ").replace(/^[ \s]+|[ \s]+$/g,"");k=o[l].getElementsByTagName("img");var g=o[l].getElementsByTagName("p");if(g[g.length-1].className==="technos"){h=$.map(g[g.length-1].innerText.split(":")[1].split(","),$.trim)}projects.push(new Project(e.p_id,d,m,i,h,k))}}).children("dt").each(function(d){$(this).bind("click",function(f){var e=function(g){var h=window.event||g;if(h.keyCode==27){$(document).unbind("keydown",e);closeDetail();removeNavigation();return false}};overlay.appendTo("body").hide().fadeTo(300,0.9,function(){current_idx=d;$viewport.appendTo("body");setContent(projects[d],$viewport);addNavigation($viewport);$(document).bind("keydown",e)});return false})})});